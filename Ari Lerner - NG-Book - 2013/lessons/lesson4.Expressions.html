<!DOCTYPE html>
<html ng-app="myApp">
<head>
	<title>Simple app</title>
	<script src="lib/angular.min.js"></script>
</head>
<body>
<script>
	angular.module('emailParser',[])
	.config(['$interpolateProvider',function($interpolateProvider){
		$interpolateProvider.startSymbol('__');
		$interpolateProvider.endSymbol('__');
	}])
	.factory('EmailParser',['$interpolate',function($interpolate){
		return {
			parse: function(text,context){
				var template = $interpolate(text);
				return template(context);
			}
		};
	}]);
	angular.module('myApp',['emailParser'])
	.controller('InterpolateController',['$scope','EmailParser',function($scope,EmailParser){
		$scope.$watch('emailBody',function(body){
			if(body){
				$scope.previewText =
					EmailParser.parse(body,{
						to: $scope.to
					});
			};
		});
	}]);
</script>
	<div ng-controller="InterpolateController">
		<input ng-model="to"
			   type="email"
			   placeholder="Recipient">
			   <br>
		<textarea ng-model="emailBody"></textarea>
		<pre> __previewText__ </pre>
	</div>
</body>
</html>